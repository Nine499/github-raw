# GitHub Raw Proxy - Agent å¼€å‘æŒ‡å—

## é¡¹ç›®æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªåŸºäºŽ Vercel çš„ GitHub æ–‡ä»¶ä»£ç†æœåŠ¡ï¼Œä¸“é—¨ä¸ºæ–°æ‰‹è®¾è®¡ï¼Œä»£ç ç»“æž„æ¸…æ™°ã€æ³¨é‡Šè¯¦ç»†ã€‚

**æ ¸å¿ƒåŠŸèƒ½**ï¼š

- ä»¤ç‰ŒéªŒè¯
- é€Ÿåº¦é™åˆ¶
- æ™ºèƒ½ç¼“å­˜
- å®‰å…¨éªŒè¯

## å¼€å‘å‘½ä»¤

```bash
# æœ¬åœ°å¼€å‘
npm run dev

# ä»£ç æ£€æŸ¥
npm run lint

# è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
npm run lint:fix

# éƒ¨ç½²åˆ°ç”Ÿäº§çŽ¯å¢ƒ
npm run deploy

# æŸ¥çœ‹æ—¥å¿—
npm run logs
```

## æµ‹è¯•è¯´æ˜Ž

é¡¹ç›®å†…ç½®å®Œæ•´æµ‹è¯•å¥—ä»¶ï¼Œè¦†ç›–æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ã€‚

è¿è¡Œæµ‹è¯•ï¼š
```bash
# åˆ›å»ºä¸´æ—¶æµ‹è¯•æ–‡ä»¶
cat > test-all.js << 'EOF'
import { RateLimiter, SimpleCache, validateToken, validatePath, sanitizePath, validateFileType, getClientIP } from "./api/github-raw.js";
// ... æµ‹è¯•ä»£ç  ...
EOF

# è¿è¡Œæµ‹è¯•
node test-all.js

# æ¸…ç†æµ‹è¯•æ–‡ä»¶
rm test-all.js
```

æµ‹è¯•è¦†ç›–ï¼š
- âœ… getClientIP å‡½æ•°ï¼ˆ4 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… validateToken å‡½æ•°ï¼ˆ4 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… validatePath å‡½æ•°ï¼ˆ8 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… sanitizePath å‡½æ•°ï¼ˆ6 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… validateFileType å‡½æ•°ï¼ˆ8 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… SimpleCache ç±»ï¼ˆ7 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰
- âœ… RateLimiter ç±»ï¼ˆ5 ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼‰

æ€»è®¡ï¼š42 ä¸ªæµ‹è¯•ç”¨ä¾‹

## ä»£ç ç»“æž„ (7 ä¸ªéƒ¨åˆ†)

ä»£ç æŒ‰é€»è¾‘åˆ†ä¸º 7 ä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†éƒ½æœ‰æ¸…æ™°çš„åˆ†éš”æ³¨é‡Šï¼š

1. **åŸºç¡€é…ç½®** - æ‰€æœ‰å¸¸é‡å’Œé…ç½®é¡¹
2. **å·¥å…·å‡½æ•°** - çº¯å‡½æ•°ï¼Œæ— å‰¯ä½œç”¨
   - `getClientIP()` - èŽ·å–å®¢æˆ·ç«¯ IP åœ°å€ï¼ˆæ”¯æŒå¤šç§ä»£ç†çŽ¯å¢ƒï¼‰
3. **æ ¸å¿ƒç±»** - SimpleCache å’Œ RateLimiter
4. **GitHub API è°ƒç”¨** - fetchFromGitHub å‡½æ•°
5. **å“åº”å¤„ç†** - è¾…åŠ©å‡½æ•°
6. **ä¸»å¤„ç†å‡½æ•°** - handler å‡½æ•°ï¼ˆå…¥å£ï¼‰
   - æ‰€æœ‰æ—¥å¿—åŒ…å«å®¢æˆ·ç«¯ IP åœ°å€
7. **å¯¼å‡º** - æµ‹è¯•ç”¨çš„å¯¼å‡º

## ä»£ç é£Žæ ¼è§„èŒƒ

### åŸºç¡€æ ¼å¼

- **ç¼©è¿›**: 2 ç©ºæ ¼ (ESLint å¼ºåˆ¶)
- **å¼•å·**: åŒå¼•å·
- **åˆ†å·**: å¿…é¡»ä½¿ç”¨
- **æ¢è¡Œç¬¦**: Unix é£Žæ ¼ (\n)
- **æ–‡ä»¶ç¼–ç **: UTF-8

### å˜é‡å£°æ˜Ž

- **ç¦æ­¢ä½¿ç”¨ `var`**: ä¸€å¾‹ä½¿ç”¨ `let` æˆ– `const`
- **ä¼˜å…ˆä½¿ç”¨ `const`**: é™¤éžéœ€è¦é‡æ–°èµ‹å€¼æ‰ç”¨ `let`
- **æ¯”è¾ƒè¿ç®—**: å¿…é¡»ä½¿ç”¨ `===` å’Œ `!==`ï¼Œç¦æ­¢ `==` å’Œ `!=`

### å‘½åçº¦å®š

- **å¸¸é‡**: UPPER_SNAKE_CASE (å¦‚ DEBUG_MODE, GITHUB_BASE_URL)
- **ç±»å**: PascalCase (å¦‚ RateLimiter, SimpleCache)
- **å‡½æ•°å**: camelCase (å¦‚ parseRequestParams, validateToken)
- **å˜é‡å**: camelCase (å¦‚ userToken, githubPath)
- **ç§æœ‰æ–¹æ³•**: ä»¥ä¸‹åˆ’çº¿å¼€å¤´ (å¯é€‰)

### æ³¨é‡Šé£Žæ ¼

- **æ–‡ä»¶å¤´éƒ¨**: ä½¿ç”¨ JSDoc æ ¼å¼ï¼ŒåŒ…å«åŠŸèƒ½æè¿°ã€å·¥ä½œæµç¨‹ã€ä½¿ç”¨æ–¹æ³•
- **å‡½æ•°/æ–¹æ³•**: å¿…é¡»ä½¿ç”¨ JSDocï¼ŒåŒ…å« `@param` å’Œ `@returns`
- **åˆ†åŒºåˆ†éš”**: ä½¿ç”¨ `// ============================================` æ ‡è®°æ¯ä¸ªéƒ¨åˆ†
- **æ­¥éª¤æ³¨é‡Š**: ä¸»å‡½æ•°ä¸­ä½¿ç”¨ `// æ­¥éª¤ X:` æ ‡è®°å¤„ç†æµç¨‹
- **æ—¥å¿—æ¶ˆæ¯**: ä½¿ç”¨ä¸­æ–‡ï¼Œå¸¦ emoji å‰ç¼€ (âœ… âŒ âš ï¸ ðŸ“¥ ðŸ—‘ï¸)

### å¯¼å…¥/å¯¼å‡º

- **æ¨¡å—ç³»ç»Ÿ**: ä½¿ç”¨ ES Modules (`export default`, `export`)
- **å¯¼å…¥é¡ºåº**: Node.js å†…ç½®æ¨¡å— â†’ ç¬¬ä¸‰æ–¹æ¨¡å— â†’ ç›¸å¯¹è·¯å¾„
- **å¯¼å‡º**: ä¸» handler ä½¿ç”¨ `export default`ï¼Œå·¥å…·å‡½æ•°ä½¿ç”¨ `export`

### é”™è¯¯å¤„ç†

- **å¼‚æ­¥æ“ä½œ**: ä½¿ç”¨ try-catch åŒ…è£…
- **é”™è¯¯åˆ†ç±»**: åŒºåˆ†ç½‘ç»œé”™è¯¯ã€è¶…æ—¶é”™è¯¯ã€éªŒè¯é”™è¯¯
- **é”™è¯¯å“åº”**: è¿”å›žç»Ÿä¸€æ ¼å¼ `{ success: false, error, details }`
- **å¼‚å¸¸æ•èŽ·**: ä¸» handler å‡½æ•°å¿…é¡»æœ‰ try-catch

### æ—¥å¿—è®°å½•

- **è°ƒè¯•æ—¥å¿—**: `DEBUG_MODE` å¼€å…³æŽ§åˆ¶
- **æ—¥å¿—çº§åˆ«**: `console.info` (æˆåŠŸ), `console.warn` (è­¦å‘Š), `console.error` (é”™è¯¯)
- **ç”Ÿäº§çŽ¯å¢ƒ**: å…³é—­è¯¦ç»†æ—¥å¿—ï¼Œä»…è®°å½•å…³é”®ä¿¡æ¯
- **å¼€å‘çŽ¯å¢ƒ**: è®°å½•è¯¦ç»†å †æ ˆå’Œè°ƒè¯•ä¿¡æ¯
- **IP è®°å½•**: æ‰€æœ‰æ—¥å¿—åŒ…å«å®¢æˆ·ç«¯ IP åœ°å€ï¼Œä¾¿äºŽè¿½è¸ªå’Œè°ƒè¯•

### å®‰å…¨è§„èŒƒ

- **è·¯å¾„éªŒè¯**: å¿…é¡»éªŒè¯ç”¨æˆ·è¾“å…¥è·¯å¾„ï¼Œé˜²æ­¢ç›®å½•éåŽ†æ”»å‡»
- **ä»¤ç‰ŒéªŒè¯**: æ‰€æœ‰ API è°ƒç”¨å¿…é¡»é€šè¿‡ä»¤ç‰ŒéªŒè¯
- **é€ŸçŽ‡é™åˆ¶**: ä½¿ç”¨ RateLimiter é˜²æ­¢æ»¥ç”¨
- **æ–‡ä»¶ç±»åž‹**: ä½¿ç”¨ç™½åå•éªŒè¯ Content-Type

### æ–°æ‰‹å‹å¥½åŽŸåˆ™

- **è¶…è¯¦ç»†æ³¨é‡Š**: æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸­æ–‡è¯´æ˜Ž
- **æ­¥éª¤æ¸…æ™°**: ä¸»å‡½æ•°æŒ‰æ­¥éª¤ç¼–å·
- **æ¯”å–»ç”ŸåŠ¨**: ä½¿ç”¨"å¿«é€’ä¸­è½¬ç«™"ã€"ä¸´æ—¶ä»“åº“"ç­‰æ¯”å–»
- **ç¤ºä¾‹å®Œæ•´**: æä¾›å®Œæ•´çš„ä½¿ç”¨ç¤ºä¾‹

### ä»£ç ç»„ç»‡

- **é…ç½®åŒº**: æ–‡ä»¶é¡¶éƒ¨ï¼ŒåŒ…å«æ‰€æœ‰å¸¸é‡é…ç½®
- **ç±»å®šä¹‰**: ç‹¬ç«‹çš„ç±»ï¼Œæ¯ä¸ªç±»è´Ÿè´£å•ä¸€èŒè´£
- **å·¥å…·å‡½æ•°**: çº¯å‡½æ•°ï¼Œæ— å‰¯ä½œç”¨
- **ä¸»å¤„ç†å‡½æ•°**: ä½œä¸º `export default`ï¼Œå¤„ç†è¯·æ±‚æµç¨‹

### æ€§èƒ½ä¼˜åŒ–

- **ç¼“å­˜ç­–ç•¥**: ä½¿ç”¨ SimpleCache ç¼“å­˜ GitHub å“åº”
- **è¶…æ—¶æŽ§åˆ¶**: æ‰€æœ‰ fetch è¯·æ±‚è®¾ç½®è¶…æ—¶ (10 ç§’)
- **LRU æ·˜æ±°**: ç¼“å­˜æ»¡æ—¶è‡ªåŠ¨æ·˜æ±°æœ€æ—©æ•°æ®

## çŽ¯å¢ƒå˜é‡

- `NODE_ENV`: development æˆ– production
- `NINE49TOKEN`: ç”¨æˆ·è®¿é—®ä»¤ç‰Œï¼ˆå¿…éœ€ï¼‰
- `GITHUB49TOKEN`: GitHub API ä»¤ç‰Œï¼ˆå¯é€‰ï¼‰
